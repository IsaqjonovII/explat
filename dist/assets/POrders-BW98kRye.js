import{u as e,_ as t}from"./FilterDateRange.vue_vue_type_script_setup_true_lang-zYLrnFB7.js";import{d as s,g as a,o as l,i as r,t as d,b as i,u as n,p as o,x as u,c,k as m,y as p,a as x,w as _,e as v,z as y,f as g,A as f,B as b,C as k}from"./index-pTZ7e48Z.js";import{B as h,_ as w,a as $}from"./FormFilterLabel.vue_vue_type_script_setup_true_lang-CtwkSkIZ.js";import{_ as j}from"./CAmount.vue_vue_type_script_setup_true_lang-Dl5L1-KQ.js";import{_ as V}from"./CDevice.vue_vue_type_script_setup_true_lang-BJ2XIEqB.js";import{_ as D}from"./CRequisites.vue_vue_type_script_setup_true_lang-BEauJlX-.js";import{u as C}from"./useTableFetch-DZtLCLei.js";import{_ as B}from"./BaseButton.vue_vue_type_script_setup_true_lang-riteCsVf.js";import{_ as I}from"./BaseModal.vue_vue_type_script_setup_true_lang-BeCUACXu.js";import{f as Y}from"./common-DgFtQOvP.js";import"./FormInput-CSKp9Vlr.js";const R=s({__name:"CBadge",props:{status:{}},setup:e=>(t,s)=>(l(),a("div",{class:r(["w-max px-2 text-[16px] py-0.5 rounded-[6px]",{"bg-green text-white":"success"===e.status,"bg-yellow-dark text-white":"pending"===e.status,"bg-red-light text-white":"canceled"===e.status}])},d(t.$t(`statuses.${e.status}`)),3))}),S={class:"flex items-center gap-1.5"},F={class:"text-sm"},M={class:"text-sm font-semibold text-dark-black"},U={key:0,class:"text-xs text-gray-1"},H={key:1,class:"text-sm text-gray-1"},O={class:"flex items-center mt-1 gap-1.5"},T={class:"text-sm"},A={class:"text-sm font-semibold text-dark-black"},L={key:0,class:"text-xs text-gray-1"},q={key:1,class:"text-sm text-gray-1"},z=s({__name:"CDate",props:{date:{},time:{},timeIsReady:{type:Boolean},pendingIsReady:{type:Boolean},pending_date:{},pending_time:{}},setup:e=>(t,s)=>(l(),a("div",null,[i("div",S,[i("p",F,d(t.$t("dates.created_at")),1),i("p",M,d(n(o)(e.date).format("DD.MM.YYYY")),1),e.timeIsReady?(l(),a("span",U,d(e.time),1)):(l(),a("span",H,d(n(o)(e.time).format("HH:mm")),1))]),i("div",O,[i("p",T,d(t.$t("dates.end_at")),1),i("p",A,d(n(o)(e.pending_date).format("DD.MM.YYYY")),1),e.pendingIsReady?(l(),a("span",L,d(e.pending_time),1)):(l(),a("span",q,d(n(o)(e.pending_time).format("HH:mm")),1))])]))}),P=()=>{const{t:e}=u();return[{id:1,name:e("statuses.all_statuses"),key:"all"},{id:2,name:e("statuses.success"),key:"success"},{id:3,name:e("statuses.canceled"),key:"canceled"},{id:4,name:e("statuses.pending"),key:"pending"}]},E=()=>{const{t:e}=u();return[{title:"№",key:"_index"},{title:"ID",key:"id",hasSort:!0},{title:e("orders.amount"),key:"amount",hasSort:!0},{title:e("orders.device"),key:"device",hasSort:!0},{title:e("orders.payment_method"),key:"payment_method",hasSort:!0},{title:e("orders.status"),key:"status",hasSort:!0},{title:e("orders.date"),key:"date",hasSort:!0}]},G=()=>{const{t:e}=u();return{noData:{title:e("transactions_not_found"),subtitle:e("transactions_not_found_try_again_later"),image:"/images/no-data/transactions.png"},thClass:"last:!text-left"}},J={key:0,class:"space-y-6"},K={class:"flex items-center justify-between p-4 bg-gray-5 rounded-lg"},N={class:"flex items-center gap-3"},Q={class:"text-lg font-semibold text-dark"},W={class:"text-sm text-gray-1"},X={class:"text-right"},Z={class:"text-xs text-gray-1 mt-1"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"space-y-4"},se={class:"text-md font-semibold text-dark border-b border-gray-4 pb-2"},ae={class:"space-y-3"},le={class:"flex justify-between items-center"},re={class:"text-sm text-gray-1"},de={class:"text-sm font-medium text-dark"},ie={class:"flex justify-between items-center"},ne={class:"text-sm text-gray-1"},oe={class:"text-sm text-dark"},ue={class:"flex justify-between items-center"},ce={class:"text-sm text-gray-1"},me={class:"text-sm text-dark"},pe={class:"flex justify-between items-center"},xe={class:"text-sm text-gray-1"},_e={class:"flex items-center gap-2"},ve={class:"text-sm font-mono text-dark"},ye={class:"space-y-4"},ge={class:"text-md font-semibold text-dark border-b border-gray-4 pb-2"},fe={class:"space-y-3"},be={class:"flex justify-between items-center"},ke={class:"text-sm text-gray-1"},he={class:"flex justify-between items-center"},we={class:"text-sm text-gray-1"},$e={class:"text-sm text-dark"},je={class:"space-y-4"},Ve={class:"text-md font-semibold text-dark border-b border-gray-4 pb-2"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce={class:"flex justify-between items-center"},Be={class:"text-sm text-gray-1"},Ie={class:"text-sm text-dark"},Ye={class:"flex justify-between items-center"},Re={class:"text-sm text-gray-1"},Se={class:"text-sm text-dark"},Fe={key:1,class:"flex items-center justify-center py-8"},Me={class:"flex justify-end gap-3"},Ue=g(s({__name:"OrderDetailsModal",props:{modelValue:{type:Boolean},orderUid:{}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,o=t,{t:g}=u(),{showToast:f}=y(),b=c({get:()=>s.modelValue,set:e=>o("update:modelValue",e)}),k=m(null),h=()=>{b.value=!1,k.value=null},w=e=>{switch(e){case"created":return"bg-blue/10 text-blue";case"performed":return"bg-green/10 text-green";case"expired":return"bg-red/10 text-red";default:return"bg-gray-4 text-gray-8"}};return p(()=>s.modelValue,e=>{e&&s.orderUid}),(e,t)=>(l(),x(n(I),{title:e.$t("orders.details"),modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),onClose:h,class:"max-w-2xl"},{footer:_(()=>[i("div",Me,[v(n(B),{text:e.$t("button.close"),variant:"outline",onClick:h},null,8,["text"])])]),default:_(()=>[k.value?(l(),a("div",J,[i("div",K,[i("div",N,[t[2]||(t[2]=i("div",{class:"w-12 h-12 bg-primary rounded-lg flex items-center justify-center"},[i("i",{class:"icon-document text-white text-xl"})],-1)),i("div",null,[i("h3",Q,"Order #"+d(k.value.id),1),i("p",W,d(k.value.external_id),1)])]),i("div",X,[i("span",{class:r([w(k.value.status),"px-3 py-1 rounded-full text-xs font-medium"])},d(e.$t(`orders.status.${k.value.status}`)),3),i("p",Z,"UID: "+d(k.value.uid),1)])]),i("div",ee,[i("div",te,[i("h4",se,d(e.$t("orders.basic_info")),1),i("div",ae,[i("div",le,[i("span",re,d(e.$t("orders.amount"))+":",1),i("span",de,d(k.value.amount)+" ₽",1)]),i("div",ie,[i("span",ne,d(e.$t("orders.purpose"))+":",1),i("span",oe,d(k.value.purpose),1)]),i("div",ue,[i("span",ce,d(e.$t("orders.order_ttl"))+":",1),i("span",me,d(k.value.order_ttl)+"s",1)]),i("div",pe,[i("span",xe,d(e.$t("orders.external_id"))+":",1),i("div",_e,[i("span",ve,d(k.value.external_id),1),i("i",{class:"icon-copy text-primary cursor-pointer hover:text-blue transition-300",onClick:t[0]||(t[0]=e=>(async e=>{try{await navigator.clipboard.writeText(e),f("success",g("common.copied"))}catch(t){console.error("Failed to copy:",t),f("error",g("common.copy_failed"))}})(k.value.external_id))})])])])]),i("div",ye,[i("h4",ge,d(e.$t("orders.status_timing")),1),i("div",fe,[i("div",be,[i("span",ke,d(e.$t("orders.status"))+":",1),i("span",{class:r([w(k.value.status),"px-2 py-1 rounded text-xs font-medium"])},d(e.$t(`orders.status.${k.value.status}`)),3)]),i("div",he,[i("span",we,d(e.$t("orders.perform_time"))+":",1),i("span",$e,d(k.value.perform_time?n(Y)(k.value.perform_time):e.$t("orders.not_performed")),1)])])])]),i("div",je,[i("h4",Ve,d(e.$t("orders.timestamps")),1),i("div",De,[i("div",Ce,[i("span",Be,d(e.$t("orders.created_at"))+":",1),i("span",Ie,d(n(Y)(k.value.created_at)),1)]),i("div",Ye,[i("span",Re,d(e.$t("orders.updated_at"))+":",1),i("span",Se,d(n(Y)(k.value.updated_at)),1)])])])])):(l(),a("div",Fe,[...t[3]||(t[3]=[i("div",{class:"loader"},null,-1)])]))]),_:1},8,["title","modelValue"]))}}),[["__scopeId","data-v-a999b6ff"]]),He={class:"bg-white px-6 rounded-xl"},Oe={class:"flex items-center gap-1"},Te={class:"text-sm font-medium text-dark-black"},Ae={class:"flex gap-5"},Le=g(s({__name:"POrders",setup(s){const{t:r}=u(),o=e("status",r("statuses.all_statuses")),{tableData:c,pagination:p,isLoading:x}=C("/explat/orders/",(()=>{const e={};return o.value&&o.value!==r("statuses.all_statuses")&&(e.status=o.value),e})(),["tab"]),y=m(!1),g=m("");function B(e){g.value=e.uid,y.value=!0}return(e,s)=>{var r,u;return l(),a("section",null,[i("div",He,[v(n(h),f({data:n(c),head:n(E)(),loading:n(x),title:e.$t("orders.title"),subtitle:e.$t("orders.count",{count:(null==(r=n(p))?void 0:r.count)||0}),total:(null==(u=n(p))?void 0:u.count)||0,filter:{status:n(o)}},n(G)(),{onClickToRow:B}),{id:_(({data:e})=>[i("div",Oe,[i("span",Te,[k(d(null==e?void 0:e.id)+" ",1),s[2]||(s[2]=i("i",{class:"icon-copy text-primary font-semibold"},null,-1))])])]),amount:_(({data:e})=>[v(n(j),{amount:null==e?void 0:e.amount,currency:"₽"},null,8,["amount"])]),device:_(({data:e})=>[v(n(V),{title:"Device",id:null==e?void 0:e.id},null,8,["id"])]),payment_method:_(({data:e})=>[v(n(D),{number:null==e?void 0:e.external_id,name:"Order",bank:"System",payment_method:null==e?void 0:e.purpose},null,8,["number","payment_method"])]),status:_(({data:e})=>[v(n(R),{status:null==e?void 0:e.status},null,8,["status"])]),date:_(({data:e})=>[v(n(z),{date:null==e?void 0:e.created_at,time:null==e?void 0:e.created_at},null,8,["date","time"])]),filter:_(()=>[i("div",Ae,[v(w,{label:e.$t("filter.status")},{default:_(()=>[v(n($),{modelValue:n(o),"onUpdate:modelValue":s[0]||(s[0]=e=>b(o)?o.value=e:null),options:n(P)(),"value-key":"key","option-styles":"hover:bg-gray-6","selected-option-styles":"border-none rounded-lg bg-white",class:"min-w-64"},null,8,["modelValue","options"])]),_:1},8,["label"]),v(w,{label:e.$t("interval_of_time")},{default:_(()=>[v(t,{class:"bg-white","start-date-key":"created_at__gte","end-date-key":"created_at__lte"})]),_:1},8,["label"])])]),_:1},16,["data","head","loading","title","subtitle","total","filter"])]),v(Ue,{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e),"order-uid":g.value},null,8,["modelValue","order-uid"])])}}}),[["__scopeId","data-v-54bfb2fb"]]);export{Le as default};
